---
title: '모델 학습 가이드'
description: 'LeRobot으로 Imitation Learning 모델을 학습시키는 방법'
---

import Callout from '../../../../../components/Callout.astro';
import Tabs from '../../../../../components/Tabs.astro';

<Callout type="info" title="Imitation Learning이란?">
  Imitation Learning은 인간의 시연을 관찰하여 로봇이 작업을 학습하는 방법입니다. LeRobot은 최신 딥러닝 기술을 활용하여 효과적인 모방 학습을 지원합니다.
</Callout>

## 학습 개요

LeRobot에서 지원하는 주요 Policy (Model):

1. **ACT (Action Chunking with Transformers)**: Transformer 기반의 액션 모델
2. **Diffusion Policy**: 확산 모델을 활용한 정책 학습
3. **VLA (Vision-Language-Action)**: 비전-언어 모델 기반 (SmolVLA)
4. OpenPi NVIDIA GROOT 등 다양한 모델이 계속 지원 되고 있으니 확인해보세요.

모델을 고르고 학습시키면 됩니다, 처음 학습해보시는 것이라면 ACT 를 추천합니다. 가장 가볍고 쉽습니다. 

## 학습 환경 준비

### GPU 설정

<Callout type="warning" title="GPU 권장사항">
  효율적인 학습을 위해 CUDA 지원 GPU (최소 RTX3080)를 권장합니다.
</Callout>

```bash
# CUDA 확인
nvidia-smi
```

### 학습 환경 설정

```python
# 환경 변수 설정
import os
os.environ['CUDA_VISIBLE_DEVICES'] = '0'  # GPU 0 사용
os.environ['WANDB_MODE'] = 'online'  # Weights & Biases 로깅
```

## 기본 학습 실행

```bash
# 명령줄에서 실행
python lerobot/scripts/train.py \
    --dataset-repo-id "my_dataset" \
    --policy "act" \
    --device "cuda" \
    --output-dir "./outputs/act_training" 
```
### 실제 로봇 평가

학습된 모델을 실제 로봇에서 평가:

```bash
# 로봇에서 모델 평가 실행
python -m lerobot.evaluate \
    --policy.checkpoint="outputs/act_training/checkpoint_100000" \
    --robot.type=so101_follower \
    --robot.port=/dev/ttyUSB0 \
    --robot.id=my_robot \
    --num_episodes=50 \
    --device=cuda
```

평가 결과는 자동으로 성공률과 함께 표시됩니다.

## 모델 저장 및 배포

### 모델을 HuggingFace Hub에 업로드

```bash
# 학습된 모델을 HuggingFace Hub에 업로드
python -m lerobot.push_model \
    --checkpoint-dir="./outputs/act_training/checkpoint_100000" \
    --repo-id="my_username/my_robot_policy" \
    --policy-name="act" \
    --tags="pick_place,so101" \
    --license="mit"
```

### 모델 다운로드 및 사용

```bash
# HuggingFace Hub에서 모델 다운로드
python -m lerobot.download_model \
    --repo-id="lerobot/act_pusht" \
    --local-dir="./models/act_pusht"

# 다운로드한 모델로 추론 실행
python -m lerobot.inference \
    --policy.checkpoint="./models/act_pusht" \
    --robot.type=so101_follower \
    --robot.port=/dev/ttyUSB0 \
    --robot.cameras="{ front: {type: opencv, index_or_path: 0} }" \
    --display_data=true
```

<Callout type="tip" title="모델 공유">
  학습한 모델을 HuggingFace Hub에 공유하면 다른 사람들도 사용할 수 있습니다. 
  모델 카드에 학습 데이터셋, 하드웨어 정보, 성능 지표를 포함하세요.
</Callout>

## 문제 해결

### 일반적인 문제들

<details>
<summary>학습이 수렴하지 않음</summary>

- 학습률 조정 (보통 1e-3 ~ 1e-5)
- 배치 크기 조정
- 데이터 정규화 확인
- 그래디언트 클리핑 적용

```python
optimizer = torch.optim.Adam(
    policy.parameters(),
    lr=1e-4,
    weight_decay=1e-5
)

# 그래디언트 클리핑
torch.nn.utils.clip_grad_norm_(policy.parameters(), max_norm=1.0)
```

</details>

<details>
<summary>과적합 문제</summary>

- 데이터 증강 강화
- 드롭아웃 비율 증가
- 조기 종료(Early Stopping) 적용
- 더 많은 데이터 수집

</details>

<details>
<summary>메모리 부족</summary>

- 배치 크기 감소
- 그래디언트 축적 사용
- 혼합 정밀도 학습 활성화

```python
# 혼합 정밀도 학습
from torch.cuda.amp import autocast, GradScaler

scaler = GradScaler()
with autocast():
    loss = policy.compute_loss(batch)
```

</details>

## 다음 단계

모델 학습이 완료되었다면:

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin: 2rem 0;">
  <a href="/community/docs/physical-ai/lerobot/tutorials" style="padding: 1.5rem; background: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--radius-lg); text-decoration: none; transition: all var(--transition-base);">
    <h3 style="margin: 0 0 0.5rem 0; color: var(--color-accent);"><i class="fas fa-rocket"></i> 실전 프로젝트</h3>
    <p style="margin: 0; color: var(--color-text-secondary); font-size: var(--text-sm);">학습한 모델로 실제 작업 구현</p>
  </a>
  
  <a href="/community/docs/physical-ai/lerobot/policy/smolvla" style="padding: 1.5rem; background: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--radius-lg); text-decoration: none; transition: all var(--transition-base);">
    <h3 style="margin: 0 0 0.5rem 0; color: var(--color-accent);"><i class="fas fa-language"></i> SmolVLA</h3>
    <p style="margin: 0; color: var(--color-text-secondary); font-size: var(--text-sm);">최신 비전-언어-액션 모델 활용</p>
  </a>
</div>

<Callout type="success" title="축하합니다!">
  이제 LeRobot으로 AI 모델을 학습시키는 전체 과정을 마스터했습니다. 학습한 모델을 실제 로봇에 적용하여 놀라운 결과를 만들어보세요!
</Callout>